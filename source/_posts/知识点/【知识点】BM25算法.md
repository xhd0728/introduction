---
title: BM25算法
tag:
  - NLP
  - 信息检索
category:
  - 论文学习
lang: zh-CN
abbrlink: 6d88603c
date: 2023-11-01 00:00:00
---

$BM25$算法通常用来做搜索相关性评分的，也是$ES$中的搜索算法，通常用来计算$query$和文本集合$D$中每篇文本之间的相关性。
<!--more-->
我们用$Q$表示$query$，在这里$Q$一般是一个句子。在这里我们要对$Q$进行语素解析（一般是分词），在这里以分词为例，我们对$Q$进行分词，得到$q_1,q_2,\cdots,q_t$这样一个词序列。给定文本$d \in D$，现在以计算$Q$和$d$之间的分数（相关性），其表达式如下：
$$Score(Q,d)=\sum\limits^t_{i=1}w_i\times R(q_i,d)$$
上面式子中$w_i$表示$q_i$的权重，$R(q_i,d)$为$q_i$和$d$的相关性，$Score(Q,d)$就是每个语素$q_i$和$d$的相关性的加权和。

$w_i$的计算方法有很多，一般是用$IDF$来表示的，但这里的$IDF$计算和上面的有所不同，具体的表达式如下：
$$w_i=IDF(q_i)=log\frac{N-n(q_i)+0.5}{n(qi)+0.5}$$
上面式子中$N$表示文本集合中文本的总数量，$n(q_i)$表示包含$q_i$这个词的文本的数量，$0.5$主要是做平滑处理。

$R(q_i,d)$的计算公式如下：

$$R(q_i,d)=\frac{f_i \times (k_1+1)}{f_i+K}\times \frac{qf_i\times(k_2+1)}{qf_i+k_2}$$
其中

$$K=k_1\times(1−b+b\times \frac{dl}{avgdl})$$

上面式子中$f_i$为$q_i$在文本$d$中出现的频率，$qf_i$为$q_i$在$Q$中出现的频率，$k_1,k_2,b$都是可调节的参数，$dl,avgdl$分别为文本$d$的长度和文本集$D$中所有文本的平均长度。

一般$qf_i=1$，取$k_2=0$，则可以去除后一项，将上面式子改写成：

$$R(q_i,d)=\frac{f_i\times(k_1+1)}{f_i+K}$$

通常设置$k_1=2,b=0.75$。参数$b$的作用主要是调节文本长度对相关性的影响。